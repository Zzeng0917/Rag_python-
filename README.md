**æ³¨æ„ï¼šä»¥ä¸‹å†™å¥½äº†å¤§ä½“çš„æ¡†æ¶ï¼Œä½†æ˜¯å…·ä½“ä½¿ç”¨è¿˜åœ¨å¼€å‘ä¸­**

**æ•™ç¨‹æ¥è‡ªï¼šhttps://github.com/datawhalechina/all-in-rag**

# ğŸš€ RAG Python

> ä¸€ä¸ªåŸºäº Python çš„é«˜æ€§èƒ½æ£€ç´¢å¢å¼ºç”Ÿæˆ (RAG) ç³»ç»Ÿï¼Œé›†æˆå…ˆè¿›çš„æ–‡æ¡£å¤„ç†å’Œå‘é‡æ£€ç´¢æŠ€æœ¯

[![Python](https://img.shields.io/badge/Python-3.8%2B-blue)](https://www.python.org/)
[![License](https://img.shields.io/badge/License-MIT-green.svg)](LICENSE)
[![Status](https://img.shields.io/badge/Status-Active-brightgreen)]()
[![RAG](https://img.shields.io/badge/RAG-Enhanced-red)]()

## ğŸ“‹ ç›®å½•

- [âœ¨ ç‰¹æ€§](#-ç‰¹æ€§)
- [ğŸ—ï¸ ç³»ç»Ÿæ¶æ„](#ï¸-ç³»ç»Ÿæ¶æ„)
- [ğŸš€ å¿«é€Ÿå¼€å§‹](#-å¿«é€Ÿå¼€å§‹)
- [ğŸ“ é¡¹ç›®ç»“æ„](#-é¡¹ç›®ç»“æ„)
- [âš™ï¸ é…ç½®è¯´æ˜](#ï¸-é…ç½®è¯´æ˜)
- [ğŸ”„ å·¥ä½œæµç¨‹](#-å·¥ä½œæµç¨‹)
- [ğŸ› ï¸ æŠ€æœ¯æ ˆ](#ï¸-æŠ€æœ¯æ ˆ)
- [ğŸ“– ä½¿ç”¨æŒ‡å—](#-ä½¿ç”¨æŒ‡å—)
- [ğŸ¤ è´¡çŒ®](#-è´¡çŒ®)

## âœ¨ ç‰¹æ€§

### ğŸ¯ æ ¸å¿ƒåŠŸèƒ½
- **ğŸ§  æ™ºèƒ½æ–‡æ¡£å¤„ç†**: é›†æˆ RagFlow OCR æŠ€æœ¯ï¼Œæ”¯æŒå¤šæ ¼å¼æ–‡æ¡£è§£æ
- **âš¡ é«˜æ•ˆå‘é‡æ£€ç´¢**: åŸºäº BGE åµŒå…¥æ¨¡å‹çš„å‘é‡ç›¸ä¼¼åº¦æœç´¢
- **ğŸ’¾ æ™ºèƒ½ç¼“å­˜æœºåˆ¶**: ç´¢å¼•æŒä¹…åŒ–å­˜å‚¨ï¼Œå®ç°ç¬é—´å¯åŠ¨
- **ğŸ”§ çµæ´»é…ç½®ç®¡ç†**: å¤šå±‚æ¬¡é…ç½®ç³»ç»Ÿï¼Œæ”¯æŒé»˜è®¤é…ç½®ã€è‡ªå®šä¹‰é…ç½®å’Œç¯å¢ƒå˜é‡
- **ğŸ“ ç»“æ„åŒ–åˆ†å—**: æŒ‰æ ‡é¢˜æ™ºèƒ½åˆ†å—ï¼Œå»ºç«‹æ–‡æ¡£çˆ¶å­å…³ç³»

### ğŸš€ æ€§èƒ½ä¼˜åŠ¿
- **âš¡ å¿«é€Ÿå¯åŠ¨**: ç´¢å¼•ç¼“å­˜æœºåˆ¶ï¼Œé¿å…é‡å¤æ„å»º
- **ğŸ¯ é«˜ç²¾åº¦æ£€ç´¢**: BGE å‘é‡æ¨¡å‹ï¼Œæ£€ç´¢ç²¾åº¦ä¸šç•Œé¢†å…ˆ
- **ğŸ“Š æ™ºèƒ½æ’åº**: åŸºäºç›¸å…³æ€§çš„ç»“æœæ’åºç®—æ³•
- **ğŸ”§ æ¨¡å—åŒ–è®¾è®¡**: ä¾¿äºç»´æŠ¤å’ŒåŠŸèƒ½æ‰©å±•

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„

```mermaid
graph TB
    A[ğŸ“š æ•°æ®è¾“å…¥] --> B[ğŸ“„ æ–‡æ¡£å¤„ç†<br/>RagFlow OCR]
    B --> C[ğŸ”— æ•°æ®å¢å¼º]
    C --> D[ğŸ“ æ™ºèƒ½åˆ†å—]
    D --> E[ğŸ§  å‘é‡åŒ–<br/>BGE æ¨¡å‹]
    E --> F[ğŸ” å‘é‡ç´¢å¼•]
    F --> G[ğŸ’¾ æŒä¹…åŒ–å­˜å‚¨]

    H[â“ ç”¨æˆ·æŸ¥è¯¢] --> I[ğŸ¯ å‘é‡æ£€ç´¢]
    I --> J[ğŸ“Š ç›¸å…³æ€§æ’åº]
    J --> K[ğŸ’¬ ä¸Šä¸‹æ–‡æ„å»º]
    K --> L[ğŸ¤– LLM é›†æˆ]
    L --> M[ğŸ“ æ™ºèƒ½å›ç­”]

    style A fill:#e1f5fe
    style M fill:#c8e6c9
    style F fill:#fff3e0
    style L fill:#fce4ec
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ğŸ“¦ ç¯å¢ƒè¦æ±‚

- **Python**: 3.8+
- **æ“ä½œç³»ç»Ÿ**: Windows/macOS/Linux
- **å†…å­˜**: å»ºè®® 8GB+
- **å­˜å‚¨**: æ ¹æ®æ–‡æ¡£å¤§å°è°ƒæ•´

### ğŸ”§ å®‰è£…æ­¥éª¤

1. **å…‹éš†é¡¹ç›®**
   ```bash
   git clone https://github.com/your-username/RAG_py.git
   cd RAG_py
   ```

2. **å®‰è£…ä¾èµ–**
   ```bash
   pip install -r requirements.txt
   ```

3. **é…ç½®ç¯å¢ƒ**
   ```bash
   # å¤åˆ¶é…ç½®æ¨¡æ¿
   cp config.py.example config.py

   # ç¼–è¾‘é…ç½®æ–‡ä»¶
   nano config.py
   ```

4. **å¯åŠ¨ç³»ç»Ÿ**
   ```bash
   python main.py
   ```

### âš¡ ä¸€é”®å¯åŠ¨è„šæœ¬

```bash
# ä½¿ç”¨é¢„è®¾é…ç½®å¿«é€Ÿå¯åŠ¨
bash scripts/quick_start.sh

# æˆ–ä½¿ç”¨ Python å¯åŠ¨
python -m rag_python.main --config config/production.py
```

## ğŸ“ é¡¹ç›®ç»“æ„

```
Rag_python/
â”œâ”€â”€ config.py                   # ğŸ›ï¸ é…ç½®ç®¡ç†
â”œâ”€â”€ main.py                     # ğŸš€ ä¸»ç¨‹åºå…¥å£
â”œâ”€â”€ requirements.txt            # ğŸ“¦ ä¾èµ–åˆ—è¡¨
â”œâ”€â”€ rag_modules/               # ğŸ§© æ ¸å¿ƒæ¨¡å—
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ data_preparation.py    # ğŸ“š æ•°æ®å‡†å¤‡æ¨¡å—
â”‚   â”œâ”€â”€ index_construction.py  # ğŸ—ï¸ ç´¢å¼•æ„å»ºæ¨¡å—
â”‚   â”œâ”€â”€ retrieval_optimization.py # ğŸ” æ£€ç´¢ä¼˜åŒ–æ¨¡å—
â”‚   â””â”€â”€ generation_integration.py # ğŸ¤– ç”Ÿæˆé›†æˆæ¨¡å—
â”œâ”€â”€ vector_index/              # ğŸ—‚ï¸ å‘é‡ç´¢å¼•ç¼“å­˜ï¼ˆè‡ªåŠ¨ç”Ÿæˆï¼‰
â”œâ”€â”€ config/                   # âš™ï¸ é…ç½®æ–‡ä»¶ç›®å½•
â”‚   â”œâ”€â”€ default.py           # ğŸ“‹ é»˜è®¤é…ç½®
â”‚   â”œâ”€â”€ development.py       # ğŸ› ï¸ å¼€å‘ç¯å¢ƒé…ç½®
â”‚   â””â”€â”€ production.py        # ğŸš€ ç”Ÿäº§ç¯å¢ƒé…ç½®
â”œâ”€â”€ scripts/                 # ğŸ“œ è„šæœ¬å·¥å…·
â”‚   â”œâ”€â”€ quick_start.sh      # âš¡ å¿«é€Ÿå¯åŠ¨è„šæœ¬
â”‚   â””â”€â”€ setup_env.py        # ğŸ”§ ç¯å¢ƒè®¾ç½®è„šæœ¬
â”œâ”€â”€ tests/                   # ğŸ§ª æµ‹è¯•æ–‡ä»¶
â”‚   â”œâ”€â”€ test_data_prep.py   # ğŸ“š æ•°æ®å‡†å¤‡æµ‹è¯•
â”‚   â”œâ”€â”€ test_index.py       # ğŸ—ï¸ ç´¢å¼•æ„å»ºæµ‹è¯•
â”‚   â””â”€â”€ test_retrieval.py   # ğŸ” æ£€ç´¢åŠŸèƒ½æµ‹è¯•
â”œâ”€â”€ docs/                   # ğŸ“– æ–‡æ¡£ç›®å½•
â”‚   â”œâ”€â”€ api_reference.md   # ğŸ“š API å‚è€ƒ
â”‚   â”œâ”€â”€ configuration.md   # âš™ï¸ é…ç½®æŒ‡å—
â”‚   â””â”€â”€ deployment.md      # ğŸš€ éƒ¨ç½²æŒ‡å—
â”œâ”€â”€ examples/               # ğŸ’¡ ç¤ºä¾‹ä»£ç 
â”‚   â”œâ”€â”€ basic_usage.py     # ğŸ“– åŸºç¡€ä½¿ç”¨ç¤ºä¾‹
â”‚   â””â”€â”€ advanced_config.py # ğŸ”§ é«˜çº§é…ç½®ç¤ºä¾‹
â””â”€â”€ README.md              # ğŸ“‹ é¡¹ç›®è¯´æ˜æ–‡æ¡£
```

## âš™ï¸ é…ç½®è¯´æ˜

### ğŸ›ï¸ åŸºç¡€é…ç½®

```python
# config.py
DEFAULT_CONFIG = {
    # ğŸ“ æ•°æ®é…ç½®
    "data": {
        "path": "data/documents",           # æ–‡æ¡£è·¯å¾„
        "formats": ["pdf", "docx", "txt"],  # æ”¯æŒæ ¼å¼
        "chunk_size": 1000,                # åˆ†å—å¤§å°
        "overlap": 200                     # é‡å å¤§å°
    },

    # ğŸ§  æ¨¡å‹é…ç½®
    "embedding_model": {
        "name": "BAAI/bge-large-zh-v1.5",  # BGE æ¨¡å‹
        "device": "cuda",                  # è®¾å¤‡ç±»å‹
        "batch_size": 32                   # æ‰¹å¤„ç†å¤§å°
    },

    # ğŸ’¾ ç´¢å¼•é…ç½®
    "index_save_path": "vector_index",     # ç´¢å¼•ä¿å­˜è·¯å¾„
    "index_type": "faiss",                # ç´¢å¼•ç±»å‹

    # ğŸ” æ£€ç´¢é…ç½®
    "retrieval": {
        "top_k": 5,                       # è¿”å›ç»“æœæ•°é‡
        "threshold": 0.7                  # ç›¸ä¼¼åº¦é˜ˆå€¼
    }
}
```

### ğŸŒ ç¯å¢ƒå˜é‡

```bash
# .env
HF_ENDPOINT=https://hf-mirror.com          # Hugging Face é•œåƒ
CUDA_VISIBLE_DEVICES=0                    # GPU è®¾å¤‡
RAG_LOG_LEVEL=INFO                        # æ—¥å¿—çº§åˆ«
RAG_CACHE_DIR=/path/to/cache             # ç¼“å­˜ç›®å½•
```

## ğŸ”„ å·¥ä½œæµç¨‹

### ğŸ“Š ç³»ç»Ÿå¯åŠ¨æµç¨‹

```mermaid
flowchart TD
    A[ğŸš€ ç³»ç»Ÿå¯åŠ¨] --> B[âš™ï¸ åŠ è½½é…ç½®]
    B --> C[ğŸ”§ åˆå§‹åŒ–æ¨¡å—]
    C --> D[â“ æ£€æŸ¥ç´¢å¼•ç¼“å­˜]

    D -->|âœ… å­˜åœ¨| E[âš¡ åŠ è½½å·²ä¿å­˜ç´¢å¼•<br/>ç¬é—´å¯åŠ¨]
    D -->|âŒ ä¸å­˜åœ¨| F[ğŸ“š æ•°æ®å‡†å¤‡æ¨¡å—]

    F --> G[ğŸ“„ è½½å…¥æ–‡ä»¶<br/>RagFlow OCRå¤„ç†]
    G --> H[ğŸ”— åŸæ•°æ®å¢å¼º]
    H --> I[ğŸ“ æŒ‰æ ‡é¢˜åˆ†å—]
    I --> J[ğŸ‘¥ çˆ¶å­å…³ç³»å»ºç«‹]
    J --> K[ğŸ“¦ è¾“å‡ºæ–‡æœ¬å—chunks]

    K --> L[ğŸ—ï¸ ç´¢å¼•å»ºç«‹æ¨¡å—]
    L --> M[ğŸ§  BGEåµŒå…¥æ¨¡å‹]
    M --> N[ğŸ” å‘é‡ç´¢å¼•]
    N --> O[ğŸ’¾ ç´¢å¼•æŒä¹…åŒ–]

    O --> P[ğŸ“‹ åŠ è½½æ–‡æ¡£å’Œåˆ†å—]
    E --> P
    P --> Q[âœ… ç³»ç»Ÿå°±ç»ª]
```

### ğŸ¯ æ ¸å¿ƒå¤„ç†é˜¶æ®µ

#### 1ï¸âƒ£ æ•°æ®å‡†å¤‡é˜¶æ®µ
- **ğŸ“„ æ–‡æ¡£è§£æ**: RagFlow OCR å¤šæ ¼å¼æ”¯æŒ
- **ğŸ”— æ•°æ®å¢å¼º**: ç»“æ„åŒ–ä¿¡æ¯æå–
- **ğŸ“ æ™ºèƒ½åˆ†å—**: åŸºäºæ ‡é¢˜å±‚æ¬¡åˆ†å—
- **ğŸ‘¥ å…³ç³»å»ºç«‹**: æ–‡æ¡£å—çˆ¶å­å…³ç³»æ˜ å°„

#### 2ï¸âƒ£ ç´¢å¼•æ„å»ºé˜¶æ®µ
- **ğŸ§  å‘é‡åµŒå…¥**: BGE æ¨¡å‹æ–‡æœ¬å‘é‡åŒ–
- **ğŸ” ç´¢å¼•æ„å»º**: Faiss é«˜æ•ˆå‘é‡ç´¢å¼•
- **ğŸ’¾ æŒä¹…åŒ–å­˜å‚¨**: ç´¢å¼•æœ¬åœ°ç¼“å­˜æœºåˆ¶

#### 3ï¸âƒ£ æ£€ç´¢ä¼˜åŒ–é˜¶æ®µ
- **ğŸ¯ ç›¸ä¼¼åº¦è®¡ç®—**: ä½™å¼¦ç›¸ä¼¼åº¦åŒ¹é…
- **ğŸ“Š ç»“æœæ’åº**: ç›¸å…³æ€§æ™ºèƒ½æ’åº
- **ğŸ”§ ç®—æ³•ä¼˜åŒ–**: æ£€ç´¢æ•ˆç‡æŒç»­ä¼˜åŒ–

#### 4ï¸âƒ£ ç”Ÿæˆé›†æˆé˜¶æ®µ
- **ğŸ’¬ ä¸Šä¸‹æ–‡æ„å»º**: æ£€ç´¢ç»“æœæ•´åˆ
- **ğŸ¤– LLM é›†æˆ**: å¤§è¯­è¨€æ¨¡å‹è°ƒç”¨
- **ğŸ“ å›ç­”ç”Ÿæˆ**: æ™ºèƒ½å›å¤è¾“å‡º

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

### ğŸ æ ¸å¿ƒæŠ€æœ¯
- **Python 3.8+**: ä¸»è¦å¼€å‘è¯­è¨€
- **FastAPI**: Web æ¡†æ¶ï¼ˆå¯é€‰ï¼‰
- **Pydantic**: æ•°æ®éªŒè¯å’Œé…ç½®ç®¡ç†

### ğŸ§  AI/ML æŠ€æœ¯
- **BGE (BAAI General Embedding)**: å‘é‡åµŒå…¥æ¨¡å‹
- **RagFlow**: OCR æ–‡æ¡£å¤„ç†å¼•æ“
- **Faiss**: é«˜æ•ˆå‘é‡ç›¸ä¼¼åº¦æœç´¢
- **Transformers**: Hugging Face æ¨¡å‹åº“

### ğŸ“Š æ•°æ®å¤„ç†
- **LangChain**: LLM åº”ç”¨å¼€å‘æ¡†æ¶
- **Unstructured**: æ–‡æ¡£è§£æåº“
- **NumPy**: æ•°å€¼è®¡ç®—
- **Pandas**: æ•°æ®å¤„ç†

### ğŸ—„ï¸ å­˜å‚¨æŠ€æœ¯
- **SQLite**: è½»é‡çº§æ•°æ®åº“ï¼ˆå¯é€‰ï¼‰
- **Redis**: ç¼“å­˜ç³»ç»Ÿï¼ˆå¯é€‰ï¼‰
- **HDF5**: å¤§æ•°æ®å­˜å‚¨ï¼ˆå¯é€‰ï¼‰

## ğŸ“– ä½¿ç”¨æŒ‡å—

### ğŸ“– åŸºç¡€ä½¿ç”¨

```python
from rag_python import RAGSystem

# åˆå§‹åŒ–ç³»ç»Ÿ
rag_system = RAGSystem(config_path="config.py")

# æ·»åŠ æ–‡æ¡£
rag_system.add_documents("data/documents/")

# æ‰§è¡Œæ£€ç´¢
results = rag_system.search("ä½ çš„æŸ¥è¯¢é—®é¢˜", top_k=5)

# ç”Ÿæˆå›ç­”
answer = rag_system.generate_answer("ä½ çš„æŸ¥è¯¢é—®é¢˜")
print(answer)
```

### ğŸ”§ é«˜çº§é…ç½®

```python
# è‡ªå®šä¹‰é…ç½®
custom_config = {
    "embedding_model": {
        "name": "BAAI/bge-large-zh-v1.5",
        "device": "cuda"
    },
    "retrieval": {
        "top_k": 10,
        "threshold": 0.8
    }
}

# ä½¿ç”¨è‡ªå®šä¹‰é…ç½®
rag_system = RAGSystem(config=custom_config)
```

### ğŸ“Š æ‰¹é‡å¤„ç†

```python
# æ‰¹é‡æ·»åŠ æ–‡æ¡£
documents = [
    "doc1.pdf",
    "doc2.docx",
    "doc3.txt"
]

rag_system.add_documents(documents, batch_size=100)

# æ‰¹é‡æŸ¥è¯¢
queries = [
    "é—®é¢˜1",
    "é—®é¢˜2",
    "é—®é¢˜3"
]

results = rag_system.batch_search(queries)
```



## ğŸ™ è‡´è°¢

- [BAAI](https://github.com/FlagOpen/FlagEmbedding) - ä¼˜ç§€çš„ BGE åµŒå…¥æ¨¡å‹
- [RagFlow](https://ragflow.io/) - å¼ºå¤§çš„ OCR æ–‡æ¡£å¤„ç†æŠ€æœ¯
- [Hugging Face](https://huggingface.co/) - ä¸°å¯Œçš„é¢„è®­ç»ƒæ¨¡å‹èµ„æº
- [Faiss](https://github.com/facebookresearch/faiss) - é«˜æ•ˆçš„å‘é‡ç›¸ä¼¼åº¦æœç´¢åº“

## ğŸ“ è”ç³»æˆ‘

- **é¡¹ç›®ä¸»é¡µ**: [https://github.com/Zzeng0917/Rag_python](https://github.com/Zzeng0917/Rag_python)
- **é—®é¢˜åé¦ˆ**: [Issues](https://github.com/your-username/RAG_py/issues)
- **åŠŸèƒ½å»ºè®®**: [Discussions](https://github.com/your-username/RAG_py/discussions)
- **é‚®ç®±**: zxd450273@gmail.com

---

<div align="center">

**â­ å¦‚æœè¿™ä¸ªé¡¹ç›®å¯¹ä½ æœ‰å¸®åŠ©ï¼Œè¯·ç»™æˆ‘ä»¬ä¸€ä¸ª Starï¼**

Made with â¤ï¸ by RAG Python Team

</div>
